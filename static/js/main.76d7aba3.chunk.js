(window["webpackJsonpspotify-lyrics-viewer-client"]=window["webpackJsonpspotify-lyrics-viewer-client"]||[]).push([[0],{33:function(e,t,n){e.exports=n.p+"static/media/spotify-logo-round.d154494c.png"},52:function(e,t,n){e.exports=n.p+"static/media/banner.ba112450.png"},55:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTE3OEEyQTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyQjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTI4OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTI5OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+m4QGuQAAAyRJREFUeNrEl21ojWEYx895TDPbMNlBK46IUiNmPvHBSUjaqc0H8pF5+aDUKPEBqU2NhRQpX5Rv5jWlDIWlMCv7MMSWsWwmb3tpXub4XXWdPHvc9/Gc41nu+nedc7/8r/99PffLdYdDPsvkwsgkTBwsA/PADJCnzX2gHTwBt8Hl7p537/3whn04XoDZDcpBlk+9P8AFcAghzRkJwPF4zGGw0Y9QS0mAM2AnQj77FqCzrtcwB1Hk81SYojHK4DyGuQ6mhIIrBWB9Xm7ug/6B/nZrBHBegrkFxoVGpnwBMSLR9EcEcC4qb8pP14BWcBcUgewMnF3T34VqhWMFkThLJAalwnENOAKiHpJq1FZgI2AT6HZtuxZwR9GidSHtI30jOrbawxlVX78/AbNfhHlomEUJJI89O2MqeE79T8/nk8nMBm/dK576hZgmA3cp/R4l9/UeSxiHLVIlNm4nFfT0bxyuIj7LHRTKai+zdJobwMKzcZSJb0ePV5PKN+BqAAKE47UlMnERELMM3EdYP/yrd+XYb2mOiYBiQ8OQnoRBlXrl9JZix7D1pHTazu4MoyBcnYamqAjIMTR8G4FT8LuhLsexXYYjICBiqhQBvYb6fLZIJCjPypVvaOoVAW2WcasCnL2Nq82xHJNSqlCeFcDshaPK0twkAhosjZL31QYw+1rlMpWGMArl23SBsZZO58F2tlJXmjOXS+s4WGvpMiBJT/I2PInZ6lIs9/hBsNS1hS6BG0DSqmYEDRlCXQrmy50P1oDRKTSegmNbUsA0zDMwRhPJXeCE3vWLPQMvan6X8AgIa1vcR4AkGZkDR4ejJ1UHpsaVI0g2LInpOsNFUud1rhxSV+fzC9Woz2EZkWQuja7/B+jUrgtIMpy9YCW4n4K41YfzRneW5E1KJTe4B2Zq1Q5EHEtj4U3AfEzR5SVY4l7QYQPJdN2as7RKBF0BPZqqH4VgMAMBL8Byxr7y8zCZiDlnOcEKIPmUpgB5Z2ww5RdOiiRiNajUmWda5IG6WbhsyY2fx6m8gLcoJDJFkH219M3We1+cnda93pfycZpIJEL/s/wSYADmOAwAQgdpBAAAAABJRU5ErkJggg=="},63:function(e,t,n){e.exports=n(96)},68:function(e,t,n){},90:function(e,t,n){},94:function(e,t,n){},96:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(13),l=n.n(i),o=(n(68),n(9)),c=n(16),s=n(17),u=n.n(s),m=n(23),f=n(123),d=n(111),p=n(122),g=n(110),E=n(33),h=n.n(E),y=function(e){var t=e.user,n=e.onLoggedInClick;return r.a.createElement(g.a,{variant:"outline-secondary",onClick:function(){null===t?Object(c.navigate)("/spotify-authorization"):n&&n()}},r.a.createElement("img",{src:null!==t&&void 0!==t.images&&t.images.length>0?t.images[0].url:h.a,alt:null!==t&&void 0!==t.images&&t.images.length>0?t.display_name+" Logo":"Spotify Logo Round",style:{height:20,width:20},className:"mr-2 rounded-circle"}),null!==t?t.display_name:"Sign In With Spotify")},b=n(52),v=n.n(b),A={"/":"Home","/about":"About"},k=function(e){var t=e.user,n=e.onLogout,a=Object(c.usePath)(),i=function(e){return function(){return Object(c.navigate)(e)}};return r.a.createElement(f.a,{collapseOnSelect:!0,expand:"md",bg:"light",variant:"light",sticky:"top"},r.a.createElement(d.a,null,r.a.createElement(f.a.Brand,{onClick:i("/")},r.a.createElement("img",{src:v.a,height:"30",className:"d-inline-block align-top",alt:"Emotionify Banner Logo",style:{cursor:"pointer"}})),r.a.createElement(f.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),r.a.createElement(f.a.Collapse,{id:"responsive-navbar-nav"},r.a.createElement(p.a,{className:"mr-auto"},Object.keys(A).map((function(e){return r.a.createElement(p.a.Link,{key:e,href:"#",onClick:i(e),active:a===e},A[e])}))),r.a.createElement(p.a,null,r.a.createElement(y,{user:t,onLoggedInClick:function(){window.confirm("Are you sure you want to logout?")&&n()}})))))},N=n(55),w=n.n(N),j=(n(90),function(){return r.a.createElement("footer",{className:"footer d-flex align-items-center"},r.a.createElement(d.a,{className:"text-center"},r.a.createElement("div",{className:"d-inline-flex align-items-center"},r.a.createElement("a",{href:"https://github.com/brentvollebregt/spotify-lyrics-viewer",className:"d-flex align-items-center",style:{padding:5,cursor:"pointer"}},r.a.createElement("img",{src:w.a,height:"25",alt:"GitHub Source"}),r.a.createElement("span",{className:"ml-2"},"Source")),r.a.createElement("span",{className:"ml-2"},"\u2022"),r.a.createElement("span",{className:"ml-2"},r.a.createElement("a",{href:"https://github.com/brentvollebregt"},"Brent Vollebregt")),r.a.createElement("span",{className:"ml-2"},"\u2022"),r.a.createElement("span",{className:"ml-2"},r.a.createElement("a",{href:"https://nitratine.net/"},"Nitratine.net")))))}),S=n(112),T=n(113),O=function(){return r.a.createElement(d.a,null,r.a.createElement(S.a,{className:"justify-content-md-center"},r.a.createElement(T.a,{className:"col-md-10 col-lg-8"},r.a.createElement("h2",{className:"text-center"},"About"),r.a.createElement("p",null,"Spotify Lyrics Viewer is a tool that allows you to view the lyrics of the current playing song on Spotify."),r.a.createElement("p",null,"To do this, we first log you into Spotify so we can see the current song playing. The title and artist are then used to try and find the lyrics on ",r.a.createElement("a",{href:"https://genius.com/"},"GENIUS")," and whatever lyrics matched the best are displayed to you."),r.a.createElement("p",null,"Please note that the lyrics returned may not be for the current playing song in some situations due the the lyrics not existing on GENIUS or the fact that the current playing songs title has some extra content to it aside from the actual title."))))},x=n(114),M=n(12),I=n(126),R=n(124),B=n(115),L=n(116),U=n(117),D=n(118),P=Object(M.a)({rail:{borderRadius:4,height:8},root:{color:"#52af77",height:8},thumb:{"&:focus,&:hover,&$active":{boxShadow:"inherit"},backgroundColor:"#fff",border:"2px solid currentColor",height:20,marginLeft:-12,marginTop:-6,width:20},track:{borderRadius:4,height:8}})(I.a),Z=function(e,t){return m.a.error(JSON.parse(t.responseText).error.message,{position:"bottom-center",heading:e,hideAfter:20,onClick:function(e){return e()}})},J=function(e){var t=e.albumArtUrl,n=e.title,i=e.artist,l=e.album,c=e.durationMs,s=e.progressMs,m=e.isPlaying,f=e.spotifyToken,d=Object(a.useState)(0),p=Object(o.a)(d,2),g=p[0],E=p[1],h=Object(a.useState)(!1),y=Object(o.a)(h,2),b=y[0],v=y[1],A=Object(a.useState)(null),k=Object(o.a)(A,2),N=k[0],w=k[1],j=void 0===c?0:c;Object(a.useEffect)((function(){b||E(s)}),[b,s]),Object(a.useEffect)((function(){null!==N&&clearTimeout(N);return w(setInterval((function(){!b&&m&&E((function(e){return Math.min(e+500,j)}))}),500)),function(){null!==N&&clearTimeout(N)}}),[b,m]);return r.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"130px 230px 1fr",maxWidth:700,margin:"auto",background:"#f3f3f3"}},r.a.createElement("div",{className:"m-1"},t?r.a.createElement("img",{src:t,alt:"".concat(l," Album Art"),className:"w-100"}):r.a.createElement("div",{className:"d-flex justify-content-center align-items-center h-100"},r.a.createElement(x.a,{animation:"border"}))),r.a.createElement("div",{className:"ml-1 d-flex flex-column justify-content-center"},r.a.createElement("p",{className:"m-1"},n),r.a.createElement("p",{className:"m-1"},i),r.a.createElement("p",{className:"m-1"},l)),r.a.createElement("div",{className:"p-3 align-self-center"},r.a.createElement("div",null,r.a.createElement("div",{className:"text-center"},r.a.createElement(R.a,{onClick:function(){if(f){var e=new u.a;e.setAccessToken(f),e.skipToPrevious().catch((function(e){return Z("Failed to Skip to Previous Song",e)}))}},className:"p-2"},r.a.createElement(B.a,{fontSize:"large"})),r.a.createElement(R.a,{onClick:function(){if(f){var e=new u.a;e.setAccessToken(f),m?e.pause().catch((function(e){return Z("Failed to Pause",e)})):e.play().catch((function(e){return Z("Failed to Play",e)}))}},className:"p-2"},m?r.a.createElement(L.a,{fontSize:"large"}):r.a.createElement(U.a,{fontSize:"large"})),r.a.createElement(R.a,{onClick:function(){if(f){var e=new u.a;e.setAccessToken(f),e.skipToNext().catch((function(e){Z("Failed to Skip to Next Song",e)}))}},className:"p-2"},r.a.createElement(D.a,{fontSize:"large"}))),r.a.createElement(P,{valueLabelDisplay:"off",value:g,min:0,max:j,onMouseDown:function(){return v(!0)},onMouseUp:function(){if(v(!1),f){var e=new u.a;e.setAccessToken(f),e.seek(g).catch((function(e){return Z("Failed to Seek",e)}))}},onChange:function(e,t){return E(Array.isArray(t)?t[0]:t)},className:"py-1"}))))},W=function(e){var t=e.current,n=e.token;return r.a.createElement(d.a,null,r.a.createElement(J,{albumArtUrl:h.a,title:"Advertisement",artist:"Spotify",album:"",durationMs:3e4,progressMs:null!==t.progress_ms?t.progress_ms:0,isPlaying:t.is_playing,spotifyToken:n}))},C=function(){return r.a.createElement(d.a,{className:"text-center"},r.a.createElement("h2",null,"Error"),r.a.createElement("p",null,"An unexpected error ocurred"))},G=n(58),Y=n.n(G),F=n(119),z=n(121),Q=n(120),H=n(125),X=(n(94),Object(F.a)({lyrics:{fontSize:18,lineHeight:"1.7em",whiteSpace:"pre-wrap"},root:{margin:"auto",maxWidth:700,position:"relative"},toggleSearchButton:{margin:"-6px -6px 0 0",position:"absolute",right:0,top:0}})),V=function(e){var t=e.lyrics,n=e.lyricsArtist,i=e.lyricsTitle,l=e.geniusUrl,c=X(),s=Object(a.useRef)(null),u=Object(a.useRef)(null),m=Object(a.useState)(""),f=Object(o.a)(m,2),d=f[0],p=f[1],E=Object(a.useState)(!1),h=Object(o.a)(E,2),y=h[0],b=h[1];Object(a.useEffect)((function(){if(null!==s.current){var e=new Y.a(s.current);e.unmark(),""!==d&&e.mark(d)}}),[d,t]),Object(a.useEffect)((function(){y&&null!==u.current&&u.current.focus()}),[y]);var v=function(){return b((function(e){return!e}))};return r.a.createElement("div",{className:"".concat(c.root," text-center")},y?r.a.createElement(Q.a,{className:"mb-3"},r.a.createElement(H.a,{ref:u,onChange:function(e){return p(void 0===e.currentTarget.value?"":e.currentTarget.value)},value:d,placeholder:"Search lyrics you heard to find your position...",className:"text-center"}),r.a.createElement(Q.a.Append,null,r.a.createElement(g.a,{variant:"outline-secondary",onClick:v},"Close"))):r.a.createElement(R.a,{className:c.toggleSearchButton,onClick:v},r.a.createElement(z.a,{fontSize:"small"})),t?r.a.createElement("div",null,r.a.createElement("div",{className:c.lyrics,ref:s},t),r.a.createElement("div",{className:"mt-4 text-left"},r.a.createElement("a",{href:"https://genius.com".concat(l),target:"_blank"},"Lyrics for ",i," by ",n))):r.a.createElement(x.a,{animation:"border"}))},_=function(){return r.a.createElement(d.a,null,r.a.createElement(J,{albumArtUrl:void 0,title:"",artist:"",album:"",durationMs:0,progressMs:0,isPlaying:!1,spotifyToken:void 0}),r.a.createElement("div",{className:"mt-3"},r.a.createElement(V,{lyrics:void 0,lyricsArtist:void 0,lyricsTitle:void 0,geniusUrl:void 0})))},K=function(){return r.a.createElement(d.a,{className:"text-center"},r.a.createElement("h2",null,"No Song is Playing"),r.a.createElement("p",null,"A song must be playing on Spotify for lyrics to be displayed.",r.a.createElement("br",null),"Also make sure you are not using a private session."))},q=function(e){var t=e.current,n=e.lyricDetails,a=e.token,i=t.item?t.item.album.images[0].url:void 0,l=t.item?t.item.name:void 0,o=t.item?t.item.artists.map((function(e){return e.name})).join(", "):void 0,c=t.item?t.item.album.name:void 0,s=null!==t.item?t.item.duration_ms:0,u=null!==t.progress_ms?t.progress_ms:0,m=t.is_playing;return r.a.createElement(d.a,null,r.a.createElement(J,{albumArtUrl:i,title:l,artist:o,album:c,durationMs:s,progressMs:u,isPlaying:m,spotifyToken:a}),r.a.createElement("div",{className:"mt-3"},r.a.createElement(V,{lyrics:n?n.content:void 0,lyricsArtist:n?n.artist:void 0,lyricsTitle:n?n.title:void 0,geniusUrl:n?n.geniusUrl:void 0})))},$=function(e){var t=e.user;return r.a.createElement(d.a,{className:"text-center"},r.a.createElement("h2",null,"Spotify Lyrics Viewer"),r.a.createElement("p",null,"To get access to your current playing song, you need to sign into Spotify."),r.a.createElement(y,{user:t}))},ee={api:{root:"https://spotify-lyrics-viewer.herokuapp.com",spotify_authentication_route:"/api/spotify/authenticate"}};var te=function(e){var t=e.token,n=e.user,i=Object(a.useState)("Loading"),l=Object(o.a)(i,2),c=l[0],s=l[1],f=Object(a.useState)(void 0),d=Object(o.a)(f,2),p=d[0],g=d[1],E=Object(a.useState)(null),h=Object(o.a)(E,2),y=h[0],b=h[1],v=function(e){var t=new u.a;t.setAccessToken(e),t.getMyCurrentPlayingTrack().then((function(e){s(""===e?"NotPlaying":e)})).catch((function(e){s("Error"),m.a.error(e.responseText,{position:"bottom-center",heading:"Failed to Get Current Song",hideAfter:20,onClick:function(e){return e()}})}))};return Object(a.useEffect)((function(){null!==t?v(t.value):s("Loading")}),[t]),Object(a.useEffect)((function(){if(null!==y&&clearTimeout(y),"NotPlaying"!==c&&"Loading"!==c&&"Error"!==c&&c.item){var e=c.item.duration_ms-(null===c.progress_ms?0:c.progress_ms)+500;b(setTimeout((function(){null!==t&&v(t.value)}),e))}return function(){null!==y&&clearTimeout(y)}}),[c]),Object(a.useEffect)((function(){var e=setInterval((function(){null!==t&&v(t.value)}),5e3);return function(){return clearTimeout(e)}}),[t]),Object(a.useEffect)((function(){"NotPlaying"!==c&&"Loading"!==c&&"Error"!==c&&c.item?void 0!==p&&c.item.id===p.spotifyId||(g(void 0),function(e,t){var n={artist:e,title:t};return fetch("".concat(ee.api.root,"/api/genius/lyrics?").concat(new URLSearchParams(n))).then((function(e){return e.json()}))}(c.item.artists[0].name,c.item.name).then((function(e){null!==c.item&&g({artist:e.artist,content:e.lyrics,geniusUrl:e.geniusUrl,spotifyId:c.item.id,title:e.title})}))):g(void 0)}),[c]),null===n?r.a.createElement($,{user:n}):"Loading"===c?r.a.createElement(_,null):"NotPlaying"===c?r.a.createElement(K,null):"Error"===c?r.a.createElement(C,null):"ad"===c.currently_playing_type?r.a.createElement(W,{current:c,token:null===t?void 0:t.value}):r.a.createElement(q,{current:c,lyricDetails:p,token:null===t?void 0:t.value})},ne=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Not Found"))},ae=function(e){var t=e.onNewToken,n=window.location.search,a=r.a.createElement(r.a.Fragment,null);if(""===n)window.location.href=ee.api.root+ee.api.spotify_authentication_route,a=r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{animation:"border"}),r.a.createElement("p",{className:"lead"},"Redirecting"));else{var i=new URLSearchParams(n.substr(1)),l=i.get("access_token"),o=i.get("expires_at");null!==l&&null!==o?(t(l,parseInt(o,10)),Object(c.navigate)("/"),a=r.a.createElement("p",{className:"lead"},"Token received")):a=r.a.createElement("p",{className:"lead"},"Incorrect URL parameters")}return r.a.createElement(d.a,{className:"text-center"},r.a.createElement("h1",null,"Spotify Authorization"),a)},re=function(){var e=Object(a.useState)(null),t=Object(o.a)(e,2),n=t[0],i=t[1],l=Object(a.useState)(null),s=Object(o.a)(l,2),f=s[0],d=s[1],p=Object(a.useState)(null),g=Object(o.a)(p,2),E=g[0],h=g[1];Object(a.useEffect)((function(){if(null===n)d(null);else{var e=new u.a;e.setAccessToken(n.value),e.getMe().then((function(e){return d(e)})).catch((function(e){return m.a.error("Could not get your profile. Make sure you are connected to the internet and that your token is valid.",{position:"bottom-center",heading:"Error When Fetching Your Profile",hideAfter:20,onClick:function(e){return e()}})}))}}),[n]),Object(a.useEffect)((function(){if(null!==E&&clearTimeout(E),null!==n){var e=n.expiry.getTime()-(new Date).getTime()-6e4;h(setTimeout((function(){fetch("".concat(ee.api.root,"/api/spotify/refresh-token"),{credentials:"include"}).then((function(e){return 200===e.status?e.json():null})).then((function(e){null!==e?y(e.access_token,e.expires_at):(m.a.warn("Unable to keep logged into Spotify. Please log back in.",{position:"bottom-center",heading:"Spotify Login Expired",hideAfter:20,onClick:function(e){return e()}}),b())}))}),e))}return function(){null!==E&&clearTimeout(E)}}),[n]),Object(a.useEffect)((function(){fetch("".concat(ee.api.root,"/api/spotify/token"),{credentials:"include"}).then((function(e){return 200===e.status?e.json():null})).then((function(e){null!==e&&y(e.access_token,e.expires_at)}))}),[]);var y=function(e,t){i({expiry:new Date(t),value:e})},b=function(){i(null),fetch("".concat(ee.api.root,"/api/session"),{credentials:"include",method:"DELETE"})},v={"/":function(){return r.a.createElement(te,{token:n,user:f})},"/about":function(){return r.a.createElement(O,null)},"/spotify-authorization":function(){return r.a.createElement(ae,{onNewToken:y})},"/spotify-authorization/":function(){return r.a.createElement(ae,{onNewToken:y})}},A=Object(c.useRoutes)(v);return Object(c.useRedirect)("/about/","/about"),r.a.createElement(r.a.Fragment,null,r.a.createElement(k,{user:f,onLogout:b}),r.a.createElement("div",{className:"my-3"},A||r.a.createElement(ne,null)),r.a.createElement(j,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(re,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[63,1,2]]]);
//# sourceMappingURL=main.76d7aba3.chunk.js.map